"use strict";function mergeSearchModel(e,t,r,a){var i=a;a||(i={});var n=e.limit;if(!isNaN(n)){var o=parseInt(n,10);t&&t.length>0?t.indexOf(o)>=0&&(i.limit=o):i.limit=o}delete e.limit;for(var s=0,l=Object.keys(e);s<l.length;s++){var g=l[s],p=i[g],d=e[g];d&&""!==d&&(i[g]=isArray(g,p,r)?d.split(","):d)}return i}function isArray(e,t,r){if(t&&Array.isArray(t))return!0;if(r)if(Array.isArray(r)){if(r.indexOf(e)>=0)return!0}else{var a=r[e];if(a&&Array.isArray(a))return!0}return!1}function initSearchable(e,t){if(!isNaN(e.page)){var r=parseInt(e.page,10);e.page=r,r>=1&&(t.pageIndex=r)}if(!isNaN(e.limit)){var a=parseInt(e.limit,10);e.limit=a,a>0&&(t.pageSize=a)}if(!e.limit&&t.pageSize&&(e.limit=t.pageSize),isNaN(e.firstLimit))t.initPageSize=t.pageSize;else{var i=parseInt(e.firstLimit,10);i>0?(e.firstLimit=i,t.initPageSize=i):t.initPageSize=t.pageSize}var n=e.sort;if(n&&n.length>0){var o=n.charAt(0);"+"===o||"-"===o?(t.sortField=n.substring(1),t.sortType=o):(t.sortField=n,t.sortType="")}return e}function more(e){e.append=!0,e.pageIndex=e.pageIndex+1}function reset(e){removeSortStatus(e.sortTarget),e.sortTarget=null,e.sortField=null,e.append=!1,e.pageIndex=1}function changePageSize(e,t){e.initPageSize=t,e.pageSize=t,e.pageIndex=1}function changePage(e,t,r){e.pageIndex=t,e.pageSize=r,e.append=!1}function optimizeSearchModel(e,t,r){return e.fields=r,t.pageIndex&&t.pageIndex>1?e.page=t.pageIndex:delete e.page,e.limit=t.pageSize,t.appendMode&&t.initPageSize!==t.pageSize?e.firstLimit=t.initPageSize:delete e.firstLimit,t.sortField&&t.sortField.length>0?e.sort="-"===t.sortType?"-"+t.sortField:t.sortField:delete e.sort,e}function append(e,t){if(e&&t)for(var r=0,a=t;r<a.length;r++){var i=a[r];e.push(i)}return e}function showResults(e,t,r){r.pageIndex=e.page&&e.page>=1?e.page:1,t.total&&(r.itemTotal=t.total),!1===r.appendMode?showPaging(e,t,r):handleAppend(e,t,r)}function handleAppend(e,t,r){if(0===e.limit)r.appendable=!1;else{var a=e.limit;e.page<=1&&(a=e.firstLimit),!0===t.last||t.results.length<a?r.appendable=!1:r.appendable=!0}t&&0===t.results.length&&(r.appendable=!1)}function showPaging(e,t,r){r.itemTotal=t.total;var a=getPageTotal(t.total,e.limit);r.pageTotal=a,r.showPaging=!(r.pageTotal<=1||t.results&&t.results.length>=t.total)}function getDisplayFields(e){var t=e.nextSibling;if(t.querySelector||(t=e.nextSibling.nextSibling),!t.querySelector)return[];var r=t.querySelector("table"),a=[];if(r){var i=r.querySelector("thead");if(i){var n=i.querySelectorAll("th");if(n)for(var o=0,s=n;o<s.length;o++){var l=s[o].getAttribute("data-field");l&&a.push(l)}}}return a}function formatResults(e,t,r,a,i,n,o){if(e&&e.length>0){var s=!1;if(t)for(var l=0,g=e;l<g.length;l++){(f=g[l])[a]&&(s=!0),t.format(f,r)}else for(var p=0,d=e;p<d.length;p++){var f;(f=d[p])[a]&&(s=!0)}if(!s)if(i||(i=1),i<=1)for(var u=0;u<e.length;u++)e[u][a]=u-n+n*i+1;else for(u=0;u<e.length;u++)e[u][a]=u-n+n*i+1-(n-o)}}function getPageTotal(e,t){return t<=0?1:e%t==0?Math.floor(e/t):Math.floor(e/t+1)}function buildSearchMessage(e,t,r){var a=t.results;if(a&&0!==a.length){e.page||(e.page=1);var i=(e.page-1)*e.limit+1,n=i+a.length-1,o=getPageTotal(t.total,e.limit);return o>1?r.format(r.value("msg_search_result_page_sequence"),i,n,t.total,e.page,o):r.format(r.value("msg_search_result_sequence"),i,n)}return r.value("msg_no_data_found")}function removeFormatUrl(e){var t=e.indexOf("?");return-1!==t?e.substring(0,t):e}function addParametersIntoUrl(e,t){if(!t){var r=e.page;r&&!isNaN(r)&&r<=1&&delete e.page;for(var a=Object.keys(e),i=window.location.host+window.location.pathname,n=removeFormatUrl(i),o=function(t){var r=e[t];if(r&&"fields"!==t)if("string"==typeof r||"number"==typeof r)-1===n.indexOf("?")?n+="?"+t+"="+r:n+="&"+t+"="+r;else if("object"==typeof r)if(r instanceof Date)-1===n.indexOf("?")?n+="?"+t+"="+r.toISOString():n+="&"+t+"="+r.toISOString();else if(Array.isArray(r)){if(r.length>0){for(var a=[],i=0,o=r;i<o.length;i++){var s=o[i];"string"==typeof s?a.push(s):"number"==typeof s&&a.push(s.toString())}-1===n.indexOf("?")?n+="?"+t+"="+a.join(","):n+="&"+t+"="+a.join(",")}}else{var l=Object.keys(r);l.forEach(function(e,a){var i=r[l[a]];-1===n.indexOf("?")?i instanceof Date?n+="?"+t+"."+e+"="+i.toISOString():n+="?"+t+"."+e+"="+i:i instanceof Date?n+="&"+t+"."+e+"="+i.toISOString():n+="&"+t+"."+e+"="+i})}},s=0,l=a;s<l.length;s++){o(l[s])}var g="http://",p=window.location.href;if(p.length>=8)"https://"===p.substr(0,8)&&(g="https://");window.history.replaceState({path:i},"",g+n)}}function handleSortEvent(e,t){if(e&&e.target){var r=e.target,a=handleSort(r,t.sortTarget,t.sortField,t.sortType);t.sortField=a.field,t.sortType=a.type,t.sortTarget=r}}function handleSort(e,t,r,a){var i=e.getAttribute("sort-type"),n=toggleSortStyle(e),o=sort(r,a,n,i);return r!==n&&removeSortStatus(t),o}function sort(e,t,r,a){return e&&""!==e?e!==r?{field:r,type:a||"+"}:e===r?{field:r,type:"+"===t?"-":"+"}:void 0:{field:r,type:"+"}}function removeSortStatus(e){e&&e.children.length>0&&e.removeChild(e.children[0])}function toggleSortStyle(e){var t=e.getAttribute("data-field");if(t||(t=e.parentNode.getAttribute("data-field")),!t||0===t.length)return"";"I"===e.nodeName&&(e=e.parentNode);var r=null;return 0===e.children.length?e.innerHTML=e.innerHTML+'<i class="sort-up"></i>':(r=e.children[0]).classList.contains("sort-up")?(r.classList.remove("sort-up"),r.classList.add("sort-down")):r.classList.contains("sort-down")&&(r.classList.remove("sort-down"),r.classList.add("sort-up")),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeSearchModel=mergeSearchModel,exports.isArray=isArray,exports.initSearchable=initSearchable,exports.more=more,exports.reset=reset,exports.changePageSize=changePageSize,exports.changePage=changePage,exports.optimizeSearchModel=optimizeSearchModel,exports.append=append,exports.showResults=showResults,exports.handleAppend=handleAppend,exports.showPaging=showPaging,exports.getDisplayFields=getDisplayFields,exports.formatResults=formatResults,exports.getPageTotal=getPageTotal,exports.buildSearchMessage=buildSearchMessage,exports.addParametersIntoUrl=addParametersIntoUrl,exports.handleSortEvent=handleSortEvent,exports.handleSort=handleSort,exports.sort=sort,exports.removeSortStatus=removeSortStatus,exports.toggleSortStyle=toggleSortStyle;